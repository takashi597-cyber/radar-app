<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Â§ßÈáéÂºè Â≠êÂÆÆÂÜÖËÜú„É¨„Éº„ÉÄ„Éº„ÉÅ„É£„Éº„Éà</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap');
        body { font-family: 'Inter', sans-serif; -webkit-tap-highlight-color: transparent; overscroll-behavior: none; }
        .active-btn { background-color: #4f46e5 !important; color: white !important; border-color: #4f46e5 !important; }
        .bonus-active { background-color: #f97316 !important; color: white !important; border-color: #f97316 !important; }
        canvas { max-height: 280px !important; width: 100% !important; }
        .no-scrollbar::-webkit-scrollbar { display: none; }
    </style>
</head>
<body class="bg-slate-50 text-slate-900">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useMemo, useEffect } = React;

        const App = () => {
            const [mode, setMode] = useState('cancer');
            const [showResetConfirm, setShowResetConfirm] = useState(false);
            const [activeGuide, setActiveGuide] = useState(null);

            // Detailed item definitions based on the provided document
            const cancerItems = [
                { id: 'nuclearLayering', label: 'Ê†∏ÈáçÁ©çÊÄß', guide: '2ÔΩû3Â±§„ÅØ5ÁÇπ„ÄÇ‰∏ÄÈÉ®ÈáçÁ©ç„ÅØ3ÁÇπ„ÄÇ1Â±§(„Ç∑„Éº„ÉàÁä∂)„ÅØ‰∏çÊï¥ÂΩ¢„Åß„ÅÇ„Å£„Å¶„ÇÇÔºç2ÁÇπ„Å®„Åô„Çã„ÄÇ', options: [{v:5, l:'5 (2-3Â±§)'}, {v:3, l:'3 (‰∏ÄÈÉ®)'}, {v:-2, l:'-2 (1Â±§)'}] },
                { id: 'atypicalClusters', label: 'Áï∞ÂΩ¢Á¥∞ËÉûÈõÜÂ°ä', guide: 'ÁØ©Áä∂(cribriform)„ÄÅÊ®πÊûùÁä∂„ÄÅback to back„ÅØÂ∞ëÊï∞„Åß„ÇÇ5ÁÇπ„ÄÇÂàÜÂ≤ê„ÇÑ‰π≥È†≠Áä∂„ÅåÁõÆÁ´ã„Å§Â†¥Âêà„ÅØ4ÁÇπ„ÄÇÂÜÜÂΩ¢„ÇÑÂúüÁÆ°Áä∂„ÅÆ„Åø„ÅØ1ÁÇπ„ÄÇ', options: [{v:5, l:'5 (ÁØ©/Ê®πÊûù)'}, {v:4, l:'4 (ÂàÜÂ≤ê)'}, {v:1, l:'1 (ÂÜÜ/ÁÆ°)'}] },
                { id: 'glandDensity', label: 'ËÖ∫ÂØÜÂ∫¶', guide: 'ÂØæÁâ©10ÂÄç„ÅßÊúÄÈ´òÂØÜÂ∫¶„ÅÆÈÉ®ÂàÜ„ÇíÊ∏¨ÂÆö„ÄÇ10ÂÄã‰ª•‰∏ä„ÅØ5ÁÇπ„ÄÅ6ÔΩû7ÂÄã„ÅØ3ÁÇπ„ÄÅ5ÂÄã‰ª•‰∏ã„ÅØ2ÁÇπ„ÄÅ„Å™„Åó„ÅØ1ÁÇπ„ÄÇ', options: [{v:5, l:'5 (10ÂÄã~)'}, {v:3, l:'3 (6-7ÂÄã)'}, {v:2, l:'2 (5ÂÄã‚Üì)'}, {v:1, l:'1 (ÁÑ°)'}] },
                { id: 'stromaAmount', label: 'ÈñìË≥™Á¥∞ËÉû„ÅÆÈáè', guide: 'Áï∞Âûã‰∏äÁöÆ„Å´ÂØæ„Åó„Å¶„ÅÆÈáè„ÇíË¶≥ÂØü„ÄÇÊ•µ„ÇÅ„Å¶Â∞ë„Å™„ÅÑ(‰∏äÁöÆÂÑ™‰Ωç)„ÅØ5ÁÇπ„ÄÇ‰∏äÁöÆ:ÈñìË≥™=1:1„Å™„Çâ3ÁÇπ„ÄÇË±äÂØå„Å™„ÇâÔºç2ÁÇπ„ÄÇ', options: [{v:5, l:'5 (Ê•µÂ∞ë)'}, {v:4, l:'4 (Â∞ë)'}, {v:3, l:'3 (1:1)'}, {v:-2, l:'-2 (Ë±äÂØå)'}] },
                { id: 'stromaClusters', label: 'ÈñìË≥™ÈõÜÂ°ä', guide: 'Áï∞ÂûãÁ¥∞ËÉûÈõÜÂ°ä„ÅÆÂë®Âõ≤„ÇíË¶≥ÂØü„ÄÇË™ç„ÇÅ„Å™„ÅÑÂ†¥Âêà„ÅØ5ÁÇπ„ÄÇÂ∞ëÊï∞„Å™„Çâ4ÁÇπ„ÄÇÂ§ßÂûãÈõÜÂ°ä„ÅßÂ§öÊï∞Ë™ç„ÇÅ„ÇãÂ†¥Âêà„ÅØ1ÁÇπ„ÄÇ', options: [{v:5, l:'5 („Å™„Åó)'}, {v:4, l:'4 (Â∞ëÊï∞)'}, {v:1, l:'1 (Â§öÊï∞)'}] },
                { id: 'cohesionLack', label: 'ÁµêÂêàÊÄß„ÅÆÊ¨†Â¶Ç', guide: 'Â∞èÈõÜÂ°ä„ÇÑÂ≠§Âú®ÊÄß„ÅåÁõÆÁ´ã„Å§(ÁµêÂêàÊÄßÊ¨†Â¶Ç)„ÅØ5ÁÇπ„ÄÇÂàÜÂåñÂ∫¶„Åå‰Ωé„ÅÑ„Åª„Å©Ê¨†Â¶Ç„Åô„ÇãÂÇæÂêë„ÄÇ‰øùÊåÅ„Åï„Çå„Å¶„ÅÑ„ÇãÂ†¥Âêà„ÅØ1ÁÇπ„ÄÇ', options: [{v:5, l:'5 (ËëóÊòé)'}, {v:4, l:'4 („ÇÑ„ÇÑ)'}, {v:1, l:'1 (‰øùÊåÅ)'}] },
                { id: 'nuclearEnlargement', label: 'Ê†∏„ÅÆÂ§ßÂûãÂåñ', guide: 'ÂÖ®‰ΩìÁöÑ„Å™Ê†∏„ÅÆÂ§ß„Åç„Åï„Å´ÁùÄÁõÆ„ÄÇÂ¢óÊÆñÊúü„ÅÆÊ†∏„Çí‰∏≠Âûã(3ÁÇπ)„Å®„Åô„Çã„ÄÇÈ´òÈΩ¢„ÉªËêéÁ∏ÆÂÜÖËÜú„ÅÆÂ†¥Âêà„ÅØËêéÁ∏ÆÊ†∏„Çí3ÁÇπ„Å®„Åô„Çã„ÄÇ', options: [{v:5, l:'5 (Â§ßÂûã)'}, {v:3, l:'3 (‰∏≠Âûã)'}, {v:1, l:'1 (Â∞èÂûã)'}] },
                { id: 'nuclearIrregularity', label: 'Ê†∏ÂΩ¢‰∏çÊï¥', guide: 'ÁõÆÁ´ã„Å§Â†¥Âêà„ÅØ5ÁÇπ„ÄÇG1(È´òÂàÜÂåñ)„Åß„ÅØÁõÆÁ´ã„Åü„Å™„ÅÑ„Åì„Å®„ÅåÂ§ö„ÅÑ„Åå„ÄÅ„Å≤„Åö„Åø„ÇÑÂàá„ÇåËæº„Åø„Åå„ÅÇ„Çå„Å∞5ÁÇπ„Å®„Åô„Çã„ÄÇ„Å™„Åó„ÅØ3ÁÇπ„ÄÇ', options: [{v:5, l:'5 (ÁõÆÁ´ã„Å§)'}, {v:4, l:'4 (‰∏ÄÈÉ®)'}, {v:3, l:'3 („Å™„Åó)'}] },
                { id: 'neutrophilCount', label: 'Â•Ω‰∏≠ÁêÉ„ÅÆÊï∞', guide: 'ÂØæÁâ©40ÂÄç„ÅßÊúÄÈ´òÂØÜÂ∫¶„ÅÆÈÉ®ÂàÜ„ÄÇ30ÂÄã‰ª•‰∏ä„ÅØ5ÁÇπ„ÄÇ10ÔΩû20ÂÄã„ÅØ3ÁÇπ„ÄÇËâØÊÄß„Åß„ÅØ30ÂÄã‰ª•‰∏ä„Åø„Çâ„Çå„Çã„Åì„Å®„ÅØÁ®Ä„ÄÇ', options: [{v:5, l:'5 (30ÂÄã~)'}, {v:3, l:'3 (10~)'}, {v:1, l:'1 (ÁÑ°/Â∞ë)'}] },
                { id: 'neutrophilInvasion', label: '‰∏äÁöÆÂÜÖ‰æµÂÖ•ÂÉè', guide: 'Áï∞ÂûãÈõÜÂ°äÂÜÖ„Å´Â•Ω‰∏≠ÁêÉ„ÇíÂ§ö„ÅèË™ç„ÇÅ„Çã(2ÔΩû3ÂÄã)Â†¥Âêà„ÅØ5ÁÇπ„ÄÇÈõÜÂ°äÂÜÖ„Å´1ÂÄã„Å™„Çâ3ÁÇπ„ÄÇ„Å™„Åó„ÅØ1ÁÇπ„ÄÇ', options: [{v:5, l:'5 (Â§ö„ÅÑ)'}, {v:3, l:'3 (1ÂÄã)'}, {v:1, l:'1 („Å™„Åó)'}] },
            ];

            const hyperplasiaItems = [
                { id: 'nuclearLayering', label: 'Ê†∏ÈáçÁ©çÊÄß', guide: '2ÔΩû3Â±§„ÅØ5ÁÇπ„ÄÇ‰∏ÄÈÉ®ÈáçÁ©ç„ÅØ3ÁÇπ„ÄÇ1Â±§(„Ç∑„Éº„ÉàÁä∂)„ÅØÂØæË±°Â§ñ„Å®„Åó„Å¶Ôºç2ÁÇπ„ÄÇ', options: [{v:5, l:'5 (2-3Â±§)'}, {v:3, l:'3 (‰∏ÄÈÉ®)'}, {v:-2, l:'-2 (1Â±§)'}] },
                { id: 'atypicalClusters', label: 'Áï∞ÂΩ¢Á¥∞ËÉûÈõÜÂ°ä', guide: '‰π≥È†≠Áä∂„ÇÑback to backÊßò„Å™„Å©‰∏çÊï¥ÂΩ¢„ÅåÂ§ö„ÅÑÂ†¥Âêà„ÅØ5ÁÇπ„ÄÇ‰∏ÄÈÉ®‰∏çÊï¥ÂΩ¢„ÅØ3ÁÇπ„ÄÇÂÜÜÂΩ¢„ÇÑÂúüÁÆ°Áä∂„ÅØ1ÁÇπ„ÄÇ', options: [{v:5, l:'5 (‰∏çÊï¥Â§ö)'}, {v:3, l:'3 (‰∏ÄÈÉ®)'}, {v:1, l:'1 (ÂÜÜ/ÁÆ°)'}] },
                { id: 'largeClusters', label: 'Â§ßÂûãÁ¥∞ËÉûÈõÜÂ°ä', guide: 'Â§ßÂûã„ÅÆÈõÜÂ°ä„ÅåÁõÆÁ´ã„Å§Â†¥Âêà„ÅØ5ÁÇπ„ÄÇ‰∏ÄÈÉ®„Å´„Åø„Çã„Å™„Çâ3ÁÇπ„ÄÇ„Å™„Åó„ÅØ1ÁÇπ„ÄÇ', options: [{v:5, l:'5 (ÁõÆÁ´ã„Å§)'}, {v:3, l:'3 (‰∏ÄÈÉ®)'}, {v:1, l:'1 („Å™„Åó)'}] },
                { id: 'branchingClusters', label: 'ÂàÜÂ≤êÁ¥∞ËÉûÈõÜÂ°ä', guide: '2ÔΩû3ÂàÜÂ≤ê„Å™„Å©ÂàÜÂ≤ê„ÅåÁõÆÁ´ã„Å§Â†¥Âêà„ÅØ5ÁÇπ„ÄÇ2ÂàÜÂ≤ê„Åæ„Åß„ÅØ3ÁÇπ„ÄÇ„Å™„Åó„ÅØ1ÁÇπ„ÄÇ', options: [{v:5, l:'5 (2-3ÂàÜ)'}, {v:3, l:'3 (2ÂàÜËøÑ)'}, {v:1, l:'1 („Å™„Åó)'}] },
                { id: 'glandDensity', label: 'ËÖ∫ÂØÜÂ∫¶', guide: 'ÂØæÁâ©10ÂÄç„ÄÇ6ÔΩû7ÂÄã‰ª•‰∏ä„ÅØ5ÁÇπ„ÄÇ4ÔΩû5ÂÄã„ÅØ3ÁÇπ„ÄÇ2ÂÄã‰ª•‰∏ã„ÅØ1ÁÇπ„ÄÇ', options: [{v:5, l:'5 (6-7ÂÄã~)'}, {v:3, l:'3 (4-5ÂÄã)'}, {v:1, l:'1 (2ÂÄã‚Üì)'}] },
                { id: 'terminalBranching', label: 'ÊúâÁ´ØÂàÜÂ≤êÈõÜÂ°ä', guide: 'ÂÖ®‰Ωì„ÅÆ20%‰ª•‰∏ä„Å´ÊúâÁ´ØÂàÜÂ≤ê„ÅåÁõÆÁ´ã„Å§Â†¥Âêà„ÅØ5ÁÇπ„ÄÇÊï∞„É∂ÊâÄ„Å™„Çâ3ÁÇπ„ÄÇ„Å™„Åó„ÅØ1ÁÇπ„ÄÇ', options: [{v:5, l:'5 (20%~)'}, {v:3, l:'3 (Êï∞„É∂ÊâÄ)'}, {v:1, l:'1 („Å™„Åó)'}] },
                { id: 'stromaComponent', label: 'ÈñìË≥™ÊàêÂàÜ', guide: '‰∏äÁöÆÊàêÂàÜ„ÅåÈñìË≥™„Å´ÂØæ„Åó„Å¶ÂÑ™‰Ωç„Åß„ÅÇ„Çã„Åì„Å®„ÅåCH‰ª•‰∏ä„ÅÆ‰∏çÂèØÊ¨†„Å™ÊâÄË¶ã„ÄÇÊ•µ„ÇÅ„Å¶Â∞ë„Å™„Åë„Çå„Å∞5ÁÇπ„ÄÇ', options: [{v:5, l:'5 (Ê•µÂ∞ë)'}, {v:3, l:'3 (1:1)'}, {v:1, l:'1 (Ë±äÂØå)'}] },
                { id: 'stromaClusters', label: 'ÈñìË≥™Á¥∞ËÉûÈõÜÂ°ä', guide: 'Ë™ç„ÇÅ„Å™„ÅÑÂ†¥Âêà„ÅØ5ÁÇπ„ÄÇÂ∞ëÊï∞„Å™„Çâ4ÁÇπ„ÄÇÂáùÈõÜÁä∂ÈñìË≥™Á¥∞ËÉûÈõÜÂ°ä„ÅåÂ§ö„ÅÑÂ†¥Âêà„ÅØÔºç2ÁÇπ„Å®„Åô„Çã„ÄÇ', options: [{v:5, l:'5 („Å™„Åó)'}, {v:4, l:'4 (Â∞ëÊï∞)'}, {v:1, l:'1 (Â§öÊï∞)'}] },
                { id: 'nuclearEnlargement', label: 'Ê†∏„ÅÆÂ§ßÂûãÂåñ', guide: 'ÂÖ®‰ΩìÁöÑ„Å´Â§ßÂûã„Å™Â†¥Âêà„ÅØ5ÁÇπ„ÄÇÂ¢óÊÆñÊúü„ÅÆÊ†∏„Å´È°û‰ºº„Åô„Çã„ÅÆ„Åå‰∏ÄËà¨ÁöÑ„ÄÇËêéÁ∏ÆÂÜÖËÜú„Å®„ÅÆÊØîËºÉ„ÅßÂà§Êñ≠„ÄÇ', options: [{v:5, l:'5 (Â§ßÂûã)'}, {v:3, l:'3 (‰∏≠Âûã)'}, {v:1, l:'1 (Â∞èÂûã)'}] },
                { id: 'neutrophilCount', label: 'Â•Ω‰∏≠ÁêÉ„ÅÆÊï∞', guide: 'ÂØæÁâ©40ÂÄç„ÄÇ30ÂÄã‰ª•‰∏ä„ÅØ5ÁÇπ„ÄÇÂ¢óÊÆñÁóá„Åß„ÅØÁôå„Å´ÊØî„Åπ30ÂÄã‰ª•‰∏ä„Åø„Çâ„Çå„Çã„Åì„Å®„ÅØÁ®Ä„ÄÇ', options: [{v:5, l:'5 (30ÂÄã~)'}, {v:3, l:'3 (10~)'}, {v:1, l:'1 (Â∞ëÊï∞)'}] },
            ];

            const getInitialScores = () => {
                const s = {};
                [...cancerItems, ...hyperplasiaItems].forEach(item => s[item.id] = null);
                return s;
            };

            const [scores, setScores] = useState(getInitialScores());
            const [bonuses, setBonuses] = useState({});

            const currentItems = mode === 'cancer' ? cancerItems : hyperplasiaItems;
            const isCompleted = useMemo(() => currentItems.every(item => scores[item.id] !== null), [scores, currentItems]);

            const executeReset = () => {
                setScores(getInitialScores());
                setBonuses({});
                setShowResetConfirm(false);
            };

            const totalScore = useMemo(() => {
                if (!isCompleted) return null;
                let sum = currentItems.reduce((acc, item) => acc + (scores[item.id] || 0), 0);
                if (mode === 'cancer') {
                    if (bonuses.necrosis) sum += 3;
                    if (bonuses.fibro) sum += 3;
                    if (bonuses.metaplasia) sum += 2;
                } else {
                    if (bonuses.metaplasia) sum += 2;
                    if (bonuses.eosin) sum += 2;
                }
                return sum;
            }, [scores, bonuses, mode, currentItems, isCompleted]);

            const diagnosis = useMemo(() => {
                if (!isCompleted) return { label: 'Êú™ÂÖ•Âäõ„ÅÆÈ†ÖÁõÆ„Åå„ÅÇ„Çä„Åæ„Åô', color: 'text-slate-400', bg: 'bg-slate-100' };
                if (mode !== 'cancer') return { label: `Â¢óÊÆñÁóá„Çπ„Ç≥„Ç¢„É™„É≥„Ç∞ÂÆå‰∫Ü`, color: 'text-indigo-600', bg: 'bg-indigo-50' };
                if (totalScore >= 47) return { label: 'Ë¶ÅÁîüÊ§úÔºöÊÇ™ÊÄß (47~)', color: 'text-red-600', bg: 'bg-red-50' };
                if (totalScore >= 40) return { label: 'Ë¶ÅÁîüÊ§úÔºöÊÇ™ÊÄß„ÇíÂº∑„ÅèÁñë„ÅÜ (40~46)', color: 'text-orange-600', bg: 'bg-orange-50' };
                if (totalScore >= 35) return { label: 'Ë¶ÅÁîüÊ§úÔºöÊÇ™ÊÄß„ÇíÁñë„ÅÜ (35~39)', color: 'text-yellow-600', bg: 'bg-yellow-50' };
                if (totalScore >= 30) return { label: 'ÁµåÈÅéË¶≥ÂØüÔºöÁï∞ÂûãÂÜÖËÜú (30~34)', color: 'text-blue-600', bg: 'bg-blue-50' };
                return { label: 'ËâØÊÄß (29‰ª•‰∏ã)', color: 'text-green-600', bg: 'bg-green-50' };
            }, [totalScore, mode, isCompleted]);

            useEffect(() => {
                const ctx = document.getElementById('radarChart');
                if (!ctx) return;
                const existingChart = Chart.getChart(ctx);
                if (existingChart) existingChart.destroy();
                new Chart(ctx, {
                    type: 'radar',
                    data: {
                        labels: currentItems.map(i => i.label),
                        datasets: [{
                            data: currentItems.map(i => scores[i.id]),
                            backgroundColor: mode === 'cancer' ? 'rgba(239, 68, 68, 0.2)' : 'rgba(79, 70, 229, 0.2)',
                            borderColor: mode === 'cancer' ? 'rgb(239, 68, 68)' : 'rgb(79, 70, 229)',
                            borderWidth: 2,
                            pointRadius: 4,
                            spanGaps: true
                        }]
                    },
                    options: {
                        scales: { r: { min: -2, max: 5, ticks: { display: false } } },
                        plugins: { legend: { display: false } },
                        maintainAspectRatio: false
                    }
                });
            }, [scores, mode, currentItems]);

            return (
                <div className="max-w-md mx-auto min-h-screen bg-slate-50 flex flex-col relative pb-10">
                    
                    {/* Reset Confirmation Overlay */}
                    {showResetConfirm && (
                        <div className="fixed inset-0 z-50 flex items-center justify-center p-6 bg-slate-900/60 backdrop-blur-sm">
                            <div className="bg-white rounded-3xl p-6 w-full shadow-2xl">
                                <h2 className="text-lg font-black mb-2">Ë©ï‰æ°„Çí„ÇØ„É™„Ç¢</h2>
                                <p className="text-sm text-slate-500 mb-6">„Åô„Åπ„Å¶„ÅÆÂÖ•Âäõ„Çí„É™„Çª„ÉÉ„Éà„Åó„Å¶ÊúÄÂàù„Åã„ÇâË®∫Êñ≠„ÇíÂßã„ÇÅ„Åæ„Åô„ÅãÔºü</p>
                                <div className="grid grid-cols-2 gap-3">
                                    <button onClick={() => setShowResetConfirm(false)} className="py-3 font-bold bg-slate-100 text-slate-600 rounded-2xl">„Ç≠„É£„É≥„Çª„É´</button>
                                    <button onClick={executeReset} className="py-3 font-bold bg-red-600 text-white rounded-2xl active:bg-red-700 shadow-lg shadow-red-200">„É™„Çª„ÉÉ„Éà</button>
                                </div>
                            </div>
                        </div>
                    )}

                    {/* Guide Modal */}
                    {activeGuide && (
                        <div className="fixed inset-0 z-50 flex items-end sm:items-center justify-center bg-slate-900/40 backdrop-blur-[2px] p-4" onClick={() => setActiveGuide(null)}>
                            <div className="bg-white rounded-[2.5rem] p-8 w-full shadow-2xl animate-in slide-in-from-bottom duration-300" onClick={e => e.stopPropagation()}>
                                <div className="flex justify-between items-start mb-4">
                                    <h2 className="text-lg font-black text-indigo-700">{activeGuide.label} „ÅÆÂà§ÂÆöÂü∫Ê∫ñ</h2>
                                    <button onClick={() => setActiveGuide(null)} className="text-slate-300 hover:text-slate-600">
                                        <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M6 18L18 6M6 6l12 12"/></svg>
                                    </button>
                                </div>
                                <p className="text-slate-600 text-sm leading-relaxed mb-6 font-medium italic border-l-4 border-indigo-200 pl-4">
                                    {activeGuide.guide}
                                </p>
                                <button onClick={() => setActiveGuide(null)} className="w-full py-4 bg-indigo-600 text-white font-bold rounded-2xl shadow-lg shadow-indigo-100 active:scale-95 transition-all">
                                    Á¢∫Ë™ç„Åó„Åæ„Åó„Åü
                                </button>
                            </div>
                        </div>
                    )}

                    {/* Header */}
                    <header className="bg-white/80 backdrop-blur-md px-4 pt-6 pb-4 shadow-sm border-b sticky top-0 z-20">
                        <div className="flex justify-between items-center mb-4">
                            <h1 className="text-lg font-black tracking-tight text-slate-800 flex items-center gap-2">
                                <span className="w-8 h-8 bg-indigo-600 rounded-xl flex items-center justify-center text-white text-xs">Radar</span>
                                <span>Â§ßÈáéÂºè Ë®∫Êñ≠„ÉÑ„Éº„É´</span>
                            </h1>
                            <button onClick={() => setShowResetConfirm(true)} className="text-[10px] font-bold text-slate-400 bg-slate-100 px-3 py-1.5 rounded-full hover:text-red-600 transition-colors">
                                üîÑ ÂàùÊúüÂåñ
                            </button>
                        </div>
                        <div className="flex bg-slate-100 p-1 rounded-2xl text-xs font-bold">
                            <button onClick={() => setMode('cancer')} className={`flex-1 py-3 rounded-xl transition-all ${mode === 'cancer' ? 'bg-white shadow-sm text-indigo-700' : 'text-slate-500'}`}>‰Ωì„Åå„Çì„É¨„Éº„ÉÄ„Éº</button>
                            <button onClick={() => setMode('hyperplasia')} className={`flex-1 py-3 rounded-xl transition-all ${mode === 'hyperplasia' ? 'bg-white shadow-sm text-indigo-700' : 'text-slate-500'}`}>Â¢óÊÆñÁóá„É¨„Éº„ÉÄ„Éº</button>
                        </div>
                    </header>

                    {/* Score View */}
                    <div className="p-4 pt-6">
                        <div className={`p-8 rounded-[2.5rem] border-2 text-center transition-all duration-500 shadow-sm ${diagnosis.bg} ${isCompleted ? diagnosis.color.replace('text', 'border') : 'border-dashed border-slate-200'}`}>
                            <div className="text-[10px] font-black uppercase tracking-[0.2em] opacity-30 mb-2">Total Diagnosis Score</div>
                            <div className={`text-7xl font-black tracking-tighter transition-all ${isCompleted ? 'text-slate-800' : 'text-slate-200'}`}>
                                {isCompleted ? totalScore : '--'}
                            </div>
                            <div className={`text-sm font-bold mt-2 ${diagnosis.color}`}>{diagnosis.label}</div>
                        </div>
                    </div>

                    {/* Chart Container */}
                    <div className="px-4 mb-4">
                        <div className="bg-white p-6 rounded-[2.5rem] border shadow-sm flex items-center justify-center relative min-h-[300px]">
                            <canvas id="radarChart"></canvas>
                        </div>
                    </div>

                    {/* Scoring Form */}
                    <div className="px-4 space-y-6">
                        <div className="bg-white p-6 rounded-[2.5rem] border shadow-sm">
                            <h3 className="text-xs font-black mb-8 text-slate-400 uppercase tracking-widest flex items-center gap-2">
                                <span className="w-1.5 h-1.5 bg-indigo-600 rounded-full"></span> Ë©ï‰æ°„Çª„ÇØ„Ç∑„Éß„É≥
                            </h3>
                            <div className="space-y-12">
                                {currentItems.map(item => (
                                    <div key={item.id} className="space-y-3">
                                        <div className="flex justify-between items-center px-1">
                                            <div className="flex items-center gap-1.5">
                                                <span className="text-sm font-black text-slate-700">{item.label}</span>
                                                <button onClick={() => setActiveGuide(item)} className="p-1 text-slate-300 hover:text-indigo-400">
                                                    <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2.5" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>
                                                </button>
                                            </div>
                                            {scores[item.id] !== null && (
                                                <span className="text-[10px] font-black bg-indigo-50 text-indigo-600 px-2 py-0.5 rounded-lg border border-indigo-100 italic">
                                                    Pt: {scores[item.id]}
                                                </span>
                                            )}
                                        </div>
                                        <div className="flex gap-2">
                                            {item.options.map(opt => (
                                                <button
                                                    key={opt.v}
                                                    onClick={() => setScores({...scores, [item.id]: opt.v})}
                                                    className={`flex-1 py-4 text-[10px] font-black rounded-2xl border transition-all active:scale-95 ${scores[item.id] === opt.v ? 'active-btn shadow-lg shadow-indigo-100' : 'bg-slate-50 text-slate-400 border-slate-100'}`}
                                                >
                                                    {opt.l}
                                                </button>
                                            ))}
                                        </div>
                                    </div>
                                ))}
                            </div>
                        </div>

                        {/* Special Features */}
                        <div className="bg-white p-6 rounded-[2.5rem] border shadow-sm mb-10">
                            <h3 className="text-xs font-black mb-4 text-orange-400 uppercase tracking-widest flex items-center gap-2">
                                <span className="w-1.5 h-1.5 bg-orange-400 rounded-full"></span> Âä†ÁÇπ„ÉªÁâπÊÆäÊâÄË¶ã
                            </h3>
                            <div className="flex flex-wrap gap-2">
                                {mode === 'cancer' ? (
                                    <>
                                        <BonusToggle active={bonuses.necrosis} onClick={() => setBonuses({...bonuses, necrosis: !bonuses.necrosis})} label="Â£äÊ≠ª (+3)" />
                                        <BonusToggle active={bonuses.fibro} onClick={() => setBonuses({...bonuses, fibro: !bonuses.fibro})} label="Á∑öÁ∂≠Ë°ÄÁÆ°ÊÄßÈñìË≥™ (+3)" />
                                        <BonusToggle active={bonuses.metaplasia} onClick={() => setBonuses({...bonuses, metaplasia: !bonuses.metaplasia})} label="ÊâÅÂπ≥‰∏äÁöÆÂåñÁîü (+2)" />
                                    </>
                                ) : (
                                    <>
                                        <BonusToggle active={bonuses.metaplasia} onClick={() => setBonuses({...bonuses, metaplasia: !bonuses.metaplasia})} label="ÊâÅÂπ≥‰∏äÁöÆÂåñÁîü (+2)" />
                                        <BonusToggle active={bonuses.eosin} onClick={() => setBonuses({...bonuses, eosin: !bonuses.eosin})} label="Â•ΩÈÖ∏ÊÄßÂåñÁîü (+2)" />
                                    </>
                                )}
                            </div>
                        </div>
                    </div>

                    <footer className="py-12 text-center px-10">
                        <p className="text-[10px] font-black text-slate-300 uppercase tracking-[0.2em] mb-2">Developed for Diagnostics</p>
                        <p className="text-[10px] text-slate-400 leading-relaxed">
                            ‰∏äÂ∞æ‰∏≠Â§ÆÁ∑èÂêàÁóÖÈô¢ Â§ßÈáéÂñú‰Ωú ËÄÉÊ°à<br/>
                            Â≠êÂÆÆÂÜÖËÜúÂ¢óÊÆñÊÄßÁóÖÂ§â„ÅÆÁ¥∞ËÉûË®∫Ë®∫Êñ≠Âü∫Ê∫ñ„Å´Âü∫„Å•„Åè
                        </p>
                    </footer>
                </div>
            );
        };

        const BonusToggle = ({ active, onClick, label }) => (
            <button 
                onClick={onClick}
                className={`px-4 py-3 rounded-2xl text-[10px] font-black border transition-all active:scale-95 ${active ? 'bonus-active shadow-lg shadow-orange-100' : 'bg-slate-50 text-slate-400 border-slate-100'}`}
            >
                {active ? 'OK' : '+'} {label}
            </button>
        );

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>

